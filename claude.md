# Sugarcane Disease Classification System

**Vision System**: Image classification using YOLOv11n-cls for mobile/edge deployment
**Dataset**: [Kaggle Sugarcane Leaf Disease Dataset](https://www.kaggle.com/datasets/nirmalsankalana/sugarcane-leaf-disease-dataset)

## Dataset Overview

- **Classes**: 5 disease categories
  - Healthy
  - Mosaic
  - Redrot
  - Rust
  - Yellow
- **Total Images**: 2,569 (balanced distribution)
- **Source**: Maharashtra, India (real-world conditions)
- **Size**: 167.3 MB

## Quick Start

### 1. Setup Kaggle API
```bash
# Get API credentials from https://www.kaggle.com/settings
# Download kaggle.json and place in ~/.kaggle/
pip install kagglehub ultralytics
```

### 2. Download Dataset
```python
import kagglehub
path = kagglehub.dataset_download("nirmalsankalana/sugarcane-leaf-disease-dataset")
print("Path to dataset files:", path)
```

### 3. Prepare Dataset
```bash
python scripts/prepare_dataset.py --source <kaggle_path> --dest dataset/
```

### 4. Train in Google Colab
```python
from ultralytics import YOLO

# Load YOLOv11n-cls (nano model for mobile)
model = YOLO('yolov11n-cls.pt')

# Train
results = model.train(
    data='dataset',
    epochs=100,
    imgsz=224,
    batch=64,
    patience=15,
    device=0  # GPU
)

# Validate
metrics = model.val()

# Export to TFLite for mobile
model.export(format='tflite')
```

## Training Workflow

**Phase 1: Data Preparation**
- Download dataset using kagglehub
- Organize into train/val/test splits (70/20/10)
- Structure: `dataset/{train,val,test}/{class_name}/`

**Phase 2: Training (Google Colab)**
- Model: YOLOv11n-cls (optimized for mobile/edge)
- Image size: 224x224
- Augmentation: Auto-enabled (rotation, scaling, color jitter)
- Expected accuracy: 90-95%
- Training time: ~2-4 hours on Colab GPU

**Phase 3: Evaluation**
- Metrics: Accuracy, Precision, Recall, F1-Score
- Confusion matrix analysis
- Per-class performance review

**Phase 4: Export & Deployment**
- Export to TFLite (Android/iOS/Raspberry Pi)
- Export to ONNX (backup/web deployment)
- Quantization: INT8 for smaller model size

## Model Selection

**YOLOv11n-cls** (Recommended for mobile/edge)
- **Size**: ~5 MB
- **Speed**: 30-60 FPS on mobile
- **Accuracy**: 90-95% expected
- **Deployment**: Optimized for edge devices

## Deployment Guide

### Mobile (TFLite)
```python
from ultralytics import YOLO

# Load exported model
model = YOLO('best.tflite')

# Inference
results = model('sugarcane_leaf.jpg')
predicted_class = results[0].probs.top1
confidence = results[0].probs.top1conf
```

### Integration
- **Android**: Use TFLite Android library
- **iOS**: Use TFLite iOS/CoreML
- **Raspberry Pi**: Direct TFLite inference
- **Web**: Convert to ONNX, use ONNX.js

## Project Structure

```
scvision/
├── claude.md                 # This file
├── requirements.txt          # Python dependencies
├── dataset/                  # Organized dataset
│   ├── train/               # Training images (70%)
│   ├── val/                 # Validation images (20%)
│   └── test/                # Test images (10%)
├── scripts/
│   └── prepare_dataset.py   # Dataset organization script
├── notebooks/
│   └── train_colab.ipynb    # Google Colab training notebook
├── models/                   # Trained model weights
└── inference.py             # Example inference script
```

## Key Configuration

**data.yaml** (auto-generated by prepare_dataset.py)
```yaml
path: /path/to/dataset
train: train
val: val
test: test
names:
  0: Healthy
  1: Mosaic
  2: Redrot
  3: Rust
  4: Yellow
```

## Performance Expectations

Based on similar agricultural disease detection research:
- **Accuracy**: 90-95%
- **Precision/Recall**: 0.90-0.95
- **F1-Score**: 0.90-0.95
- **Inference Speed**: 30-60 FPS on mobile GPU
- **Model Size**: ~5 MB (TFLite)

## Best Practices

1. **Data Augmentation**: Critical for ~513 images/class
   - Rotation (±30°)
   - Scaling (0.8-1.2x)
   - Color jitter
   - Horizontal/vertical flips

2. **Training**:
   - Use early stopping (patience=15)
   - Monitor validation metrics
   - Save best model based on val accuracy

3. **Deployment**:
   - INT8 quantization for mobile (3-4x speedup)
   - Test on target device before production
   - Implement confidence threshold (e.g., 0.7)

## Common Issues & Solutions

**Issue**: Low accuracy (<85%)
- Solution: Increase epochs, add more augmentation, try YOLOv11s-cls

**Issue**: Overfitting (train acc >> val acc)
- Solution: Stronger augmentation, reduce epochs, add dropout

**Issue**: Slow mobile inference
- Solution: Use INT8 quantization, reduce image size to 160x160

## Resources

- [Ultralytics YOLO Docs](https://docs.ultralytics.com)
- [YOLOv11 Classification](https://docs.ultralytics.com/tasks/classify/)
- [Model Export Guide](https://docs.ultralytics.com/modes/export/)
- [TFLite Integration](https://www.tensorflow.org/lite)

## Next Steps

1. ✅ Setup project structure
2. ✅ Download dataset
3. ⏳ Organize dataset (run prepare_dataset.py)
4. ⏳ Train model in Colab
5. ⏳ Evaluate and export
6. ⏳ Deploy to mobile device
